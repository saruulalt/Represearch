---
title: "Reproducible Research Assignment 1"
author: "saruulalt"
date: "December 15, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## About Assignment

This project makes use of data from a personal activity monitoring device. This device collects data at 5 minute intervals through out the day. The data consists of two months of data from an anonymous individual collected during the months of October and November, 2012 and include the number of steps taken in 5 minute intervals each day. The goal of this project is to write a report that answers the questions detailed below.

## Loading the Data

```{r}

data <- read.csv("activity.csv", header = TRUE, sep = ",", na.strings = "NA")

```

#### Let's see what the data looks like using the head():

```{r}
head(data)
```

#### Also, let's look at some summary statistics

For example, using the summary():

```{r}
summary(data)
```

## Preproccessing

Before we get to the main question, we need to do a little bit of preprocessing. It is useful to use the str() to get quick information about the structure of the data frame including the class of each variable. 

```{r}
str(data)
```

We see that we have to convert 'date' variable to Date classes and 'interval' to a factor.

```{r}
data$date <- as.Date(data$date, format = "%Y-%m-%d")
data$interval <- factor(data$interval)
```

Lastly, we can remove the missing values from 'steps' variable here in preprocessing or later. 

```{r}
NA_index <- is.na(as.character(data$steps))
df<- data[!NA_index,]
head(df)
```

Now we are ready to answer the main questions.

##Questions

####Question 1: What is mean total number of steps taken per day?

```{r}
#notice you can remove NA's here as well
totalSteps <- aggregate(steps ~ date, data = df, sum, na.rm = TRUE)

```
First, we make a  histogram:

```{r}
hist(as.numeric(totalSteps$steps), breaks = 20, col = "blue", xlab = "Number of Steps", main= "Histogram of Total Number of Steps per Day")
```

Then, calculate mean and median:

```{r}
mean(totalSteps$steps)
median(totalSteps$steps)
```

```{r}
summary(totalSteps$steps)
```

####Question 2: What is the average daily activity pattern? 

We can use aggregrate functino with mean to calculate average across recorded intervals:

```{r}
steps_interval <- aggregate(steps ~ interval, data = df, mean, na.rm = TRUE)
```

Let's see how it looks when plotted:

```{r}
plot(steps ~ interval, data = steps_interval, type = "l", xlab = "5-Min Intervals (5-minute)", ylab = "Average Number of Steps", main = "Average Daily Activity at 5 minute Intervals",  col = "blue")
```


####Question 3: How could we control for bias caused by removing missing values?

The presence of missing days may introduce bias into some calculations or summaries of the data. We need to devise a strategy for filling in all of the missing values in the dataset. One way is to fill it in with the mean/median for the day or the 5-min interval. 

Let's start by calculating total number of missing values per variable.

Steps:

```{r}
sum(is.na(as.character(data$steps)))
```

Date:

```{r}
sum(is.na(as.character(data$date)))

```

Interval:

```{r}
sum(is.na(as.character(data$interval)))

```

We see that we are only missing from 'steps' variable, a total of 2304 values.

```{r}
library(dplyr)

mean_per_interval <- data %>% group_by(interval) %>%
      summarize(mean.steps = mean(steps, na.rm = T))
```


```{r}
fill_data <- data
```

```{r}
for (i in 1:nrow(fill_data)) {
      if (is.na(fill_data$steps[i])) {
            index <- fill_data$interval[i]
            value <- subset(mean_per_interval, interval==index)
            fill_data$steps[i] <- value$mean.steps
      }
}
head(fill_data)
```


```{r}
new_totalSteps <- aggregate(steps ~ date, data = fill_data, sum, na.rm = TRUE)

```

```{r}
hist(as.numeric(new_totalSteps$steps), breaks = 20, col = "blue", xlab = "Number of Steps", main= "Histogram of Total Number of Steps per Day Revised")
```

```{r}
summary(totalSteps$steps)
```

```{r}
summary(new_totalSteps$steps)
```

The mean and median stay the same but we see some change in the 1st quartile.

####Question 4: Are there differences in activity patterns between weekdays and weekends?



